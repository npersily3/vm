\doxysection{src/threads/writer\+\_\+thread.c File Reference}
\hypertarget{writer__thread_8c}{}\label{writer__thread_8c}\index{src/threads/writer\_thread.c@{src/threads/writer\_thread.c}}


This file contains all the functions associated with writing to page that have been recently trimmed to disk.  


{\ttfamily \#include "{}../../include/threads/writer\+\_\+thread.\+h"{}}\newline
{\ttfamily \#include "{}../../include/variables/globals.\+h"{}}\newline
{\ttfamily \#include "{}../../include/variables/macros.\+h"{}}\newline
{\ttfamily \#include "{}../../include/utils/pte\+\_\+utils.\+h"{}}\newline
{\ttfamily \#include "{}../../include/utils/page\+\_\+utils.\+h"{}}\newline
{\ttfamily \#include "{}../../include/disk/disk.\+h"{}}\newline
{\ttfamily \#include "{}../../include/utils/thread\+\_\+utils.\+h"{}}\newline
{\ttfamily \#include "{}threads/user\+\_\+thread.\+h"{}}\newline
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
DWORD \mbox{\hyperlink{writer__thread_8c_a96b6b33fb62f38da93e526858136ae04}{disk\+Writer}} (LPVOID info)
\begin{DoxyCompactList}\small\item\em This function takes pages off the modified list and tries to write them to disk. It batch writes pages to disk to be more effiecient. \end{DoxyCompactList}\item 
VOID \mbox{\hyperlink{writer__thread_8c_a8af176e5e6ce9fc63b2235dacf95cdb8}{free\+Unused\+Disk\+Slots}} (PULONG64 disk\+Index\+Array, ULONG64 start, ULONG64 end)
\begin{DoxyCompactList}\small\item\em This function frees a specified range of disk indices in a given array. \end{DoxyCompactList}\item 
VOID \mbox{\hyperlink{writer__thread_8c_a831b19b858591a55cc17312a77c33874}{add\+To\+Stand\+By}} (ULONG64 local\+Batch\+Size, \mbox{\hyperlink{structpfn}{pfn}} \texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*}pfn\+Array, \mbox{\hyperlink{structures_8h_a0d2bf865b114b5aa46dd6f5558f60df4}{PTHREAD\+\_\+\+INFO}} info)
\begin{DoxyCompactList}\small\item\em Adds pages from an array onto the standby list. \end{DoxyCompactList}\item 
VOID \mbox{\hyperlink{writer__thread_8c_ab3e2cd6fe53fb407f9bc0de23eb41c1d}{write\+To\+Disk}} (ULONG64 local\+Batch\+Size, PULONG64 frame\+Number\+Array, PULONG64 disk\+Address\+Array)
\begin{DoxyCompactList}\small\item\em This function maps physical pages to an interim va in order to read the contents into the disk at specified indices. \end{DoxyCompactList}\item 
VOID \mbox{\hyperlink{writer__thread_8c_ad22897e97e19f1f68e6c8a3049ec6932}{get\+Pages\+From\+Modified\+List}} (PULONG64 local\+Batch\+Size\+Pointer, \mbox{\hyperlink{structpfn}{pfn}} \texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*}pfn\+Array, PULONG64 disk\+Index\+Array, PULONG64 frame\+Number\+Array, \mbox{\hyperlink{structures_8h_a0d2bf865b114b5aa46dd6f5558f60df4}{PTHREAD\+\_\+\+INFO}} thread\+Context)
\begin{DoxyCompactList}\small\item\em This function pops pages off the modified list and updates their status as standby, in progress write, and gives them a disk index. \end{DoxyCompactList}\item 
VOID \mbox{\hyperlink{writer__thread_8c_ae55b9d3c072a0157b7bcbd6a320e2fc6}{update\+Page}} (\mbox{\hyperlink{structpfn}{pfn}} \texorpdfstring{$\ast$}{*}page, ULONG64 disk\+Index)
\begin{DoxyCompactList}\small\item\em This function updates the page to hold a disk index and change its status to write in progress and standby. \end{DoxyCompactList}\item 
VOID \mbox{\hyperlink{writer__thread_8c_a2b89eecb0dc156e4930c2cac0a9ebd11}{get\+Disk\+Addresses\+From\+Disk\+Indices}} (PULONG64 indices, PULONG64 addresses, ULONG64 size)
\begin{DoxyCompactList}\small\item\em This function converts indices to addresses by multiplying by page size and adding the disk base. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
This file contains all the functions associated with writing to page that have been recently trimmed to disk. 

\begin{DoxyAuthor}{Author}
Noah Persily 
\end{DoxyAuthor}


\label{doc-func-members}
\Hypertarget{writer__thread_8c_doc-func-members}
\doxysubsection{Function Documentation}
\Hypertarget{writer__thread_8c_a831b19b858591a55cc17312a77c33874}\index{writer\_thread.c@{writer\_thread.c}!addToStandBy@{addToStandBy}}
\index{addToStandBy@{addToStandBy}!writer\_thread.c@{writer\_thread.c}}
\doxysubsubsection{\texorpdfstring{addToStandBy()}{addToStandBy()}}
{\footnotesize\ttfamily \label{writer__thread_8c_a831b19b858591a55cc17312a77c33874} 
VOID add\+To\+Stand\+By (\begin{DoxyParamCaption}\item[{ULONG64}]{local\+Batch\+Size}{, }\item[{\mbox{\hyperlink{structpfn}{pfn}} \texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*}}]{pfn\+Array}{, }\item[{\mbox{\hyperlink{structures_8h_a0d2bf865b114b5aa46dd6f5558f60df4}{PTHREAD\+\_\+\+INFO}}}]{info}{}\end{DoxyParamCaption})}



Adds pages from an array onto the standby list. 


\begin{DoxyParams}{Parameters}
{\em local\+Batch\+Size} & The number of pages to add \\
\hline
{\em pfn\+Array} & An array of page pointers \\
\hline
{\em info} & The info about the caller \\
\hline
\end{DoxyParams}
\Hypertarget{writer__thread_8c_a96b6b33fb62f38da93e526858136ae04}\index{writer\_thread.c@{writer\_thread.c}!diskWriter@{diskWriter}}
\index{diskWriter@{diskWriter}!writer\_thread.c@{writer\_thread.c}}
\doxysubsubsection{\texorpdfstring{diskWriter()}{diskWriter()}}
{\footnotesize\ttfamily \label{writer__thread_8c_a96b6b33fb62f38da93e526858136ae04} 
DWORD disk\+Writer (\begin{DoxyParamCaption}\item[{LPVOID}]{info}{}\end{DoxyParamCaption})}



This function takes pages off the modified list and tries to write them to disk. It batch writes pages to disk to be more effiecient. 


\begin{DoxyParams}{Parameters}
{\em info} & A pointer to a thread info struct. Passed in during the function Create\+Thread \\
\hline
\end{DoxyParams}

\begin{DoxyRetVals}{Return values}
{\em 0} & If the program succeeds \\
\hline
\end{DoxyRetVals}
\Hypertarget{writer__thread_8c_a8af176e5e6ce9fc63b2235dacf95cdb8}\index{writer\_thread.c@{writer\_thread.c}!freeUnusedDiskSlots@{freeUnusedDiskSlots}}
\index{freeUnusedDiskSlots@{freeUnusedDiskSlots}!writer\_thread.c@{writer\_thread.c}}
\doxysubsubsection{\texorpdfstring{freeUnusedDiskSlots()}{freeUnusedDiskSlots()}}
{\footnotesize\ttfamily \label{writer__thread_8c_a8af176e5e6ce9fc63b2235dacf95cdb8} 
VOID free\+Unused\+Disk\+Slots (\begin{DoxyParamCaption}\item[{PULONG64}]{disk\+Index\+Array}{, }\item[{ULONG64}]{start}{, }\item[{ULONG64}]{end}{}\end{DoxyParamCaption})}



This function frees a specified range of disk indices in a given array. 


\begin{DoxyParams}{Parameters}
{\em disk\+Index\+Array} & An array of disk indices \\
\hline
{\em start} & Where to start freeing in the array of disk indices. \\
\hline
{\em end} & Where to finish freeing in the array of disk indices. \\
\hline
\end{DoxyParams}
\Hypertarget{writer__thread_8c_a2b89eecb0dc156e4930c2cac0a9ebd11}\index{writer\_thread.c@{writer\_thread.c}!getDiskAddressesFromDiskIndices@{getDiskAddressesFromDiskIndices}}
\index{getDiskAddressesFromDiskIndices@{getDiskAddressesFromDiskIndices}!writer\_thread.c@{writer\_thread.c}}
\doxysubsubsection{\texorpdfstring{getDiskAddressesFromDiskIndices()}{getDiskAddressesFromDiskIndices()}}
{\footnotesize\ttfamily \label{writer__thread_8c_a2b89eecb0dc156e4930c2cac0a9ebd11} 
VOID get\+Disk\+Addresses\+From\+Disk\+Indices (\begin{DoxyParamCaption}\item[{PULONG64}]{indices}{, }\item[{PULONG64}]{addresses}{, }\item[{ULONG64}]{size}{}\end{DoxyParamCaption})}



This function converts indices to addresses by multiplying by page size and adding the disk base. 


\begin{DoxyParams}{Parameters}
{\em indices} & Array of disk indices that is used to get the disk addresses \\
\hline
{\em addresses} & Array of addresses that will be filled in by this function \\
\hline
{\em size} & The size of the arrays \\
\hline
\end{DoxyParams}
\Hypertarget{writer__thread_8c_ad22897e97e19f1f68e6c8a3049ec6932}\index{writer\_thread.c@{writer\_thread.c}!getPagesFromModifiedList@{getPagesFromModifiedList}}
\index{getPagesFromModifiedList@{getPagesFromModifiedList}!writer\_thread.c@{writer\_thread.c}}
\doxysubsubsection{\texorpdfstring{getPagesFromModifiedList()}{getPagesFromModifiedList()}}
{\footnotesize\ttfamily \label{writer__thread_8c_ad22897e97e19f1f68e6c8a3049ec6932} 
VOID get\+Pages\+From\+Modified\+List (\begin{DoxyParamCaption}\item[{PULONG64}]{local\+Batch\+Size\+Pointer}{, }\item[{\mbox{\hyperlink{structpfn}{pfn}} \texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*}}]{pfn\+Array}{, }\item[{PULONG64}]{disk\+Index\+Array}{, }\item[{PULONG64}]{frame\+Number\+Array}{, }\item[{\mbox{\hyperlink{structures_8h_a0d2bf865b114b5aa46dd6f5558f60df4}{PTHREAD\+\_\+\+INFO}}}]{thread\+Context}{}\end{DoxyParamCaption})}



This function pops pages off the modified list and updates their status as standby, in progress write, and gives them a disk index. 


\begin{DoxyParams}{Parameters}
{\em local\+Batch\+Size\+Pointer} & A pointer to our local batch size. If there are less pages on the modified list than disk indices, the function will update the contents of the pointer to reflect that change. \\
\hline
{\em pfn\+Array} & A location for this function to store the pages it pops of the modified list. \\
\hline
{\em disk\+Index\+Array} & An array of disk indices to update the pfns. \\
\hline
{\em frame\+Number\+Array} & An array of frame numbers to be filled in. \\
\hline
{\em thread\+Context} & The thread info of the caller. \\
\hline
\end{DoxyParams}
\Hypertarget{writer__thread_8c_ae55b9d3c072a0157b7bcbd6a320e2fc6}\index{writer\_thread.c@{writer\_thread.c}!updatePage@{updatePage}}
\index{updatePage@{updatePage}!writer\_thread.c@{writer\_thread.c}}
\doxysubsubsection{\texorpdfstring{updatePage()}{updatePage()}}
{\footnotesize\ttfamily \label{writer__thread_8c_ae55b9d3c072a0157b7bcbd6a320e2fc6} 
VOID update\+Page (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structpfn}{pfn}} \texorpdfstring{$\ast$}{*}}]{page}{, }\item[{ULONG64}]{disk\+Index}{}\end{DoxyParamCaption})}



This function updates the page to hold a disk index and change its status to write in progress and standby. 


\begin{DoxyParams}{Parameters}
{\em page} & The page to update \\
\hline
{\em disk\+Index} & The disk index to store in the page \\
\hline
\end{DoxyParams}
\begin{DoxyPrecond}{Precondition}
The page must be locked. 
\end{DoxyPrecond}
\begin{DoxyPostcond}{Postcondition}
The caller must release the page lock. 
\end{DoxyPostcond}
\Hypertarget{writer__thread_8c_ab3e2cd6fe53fb407f9bc0de23eb41c1d}\index{writer\_thread.c@{writer\_thread.c}!writeToDisk@{writeToDisk}}
\index{writeToDisk@{writeToDisk}!writer\_thread.c@{writer\_thread.c}}
\doxysubsubsection{\texorpdfstring{writeToDisk()}{writeToDisk()}}
{\footnotesize\ttfamily \label{writer__thread_8c_ab3e2cd6fe53fb407f9bc0de23eb41c1d} 
VOID write\+To\+Disk (\begin{DoxyParamCaption}\item[{ULONG64}]{local\+Batch\+Size}{, }\item[{PULONG64}]{frame\+Number\+Array}{, }\item[{PULONG64}]{disk\+Address\+Array}{}\end{DoxyParamCaption})}



This function maps physical pages to an interim va in order to read the contents into the disk at specified indices. 


\begin{DoxyParams}{Parameters}
{\em local\+Batch\+Size} & The number of disk\+Slots and frames passed \\
\hline
{\em frame\+Number\+Array} & An array of frame numbers \\
\hline
{\em disk\+Address\+Array} & An array of disk\+Addresses \\
\hline
\end{DoxyParams}
