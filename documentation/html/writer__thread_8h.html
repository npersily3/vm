<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.14.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Virtual Memory Manager: include/threads/writer_thread.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript">var page_layout=1;</script>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="side-nav" class="ui-resizable side-nav-resizable"><!-- do not remove this div, it is closed by doxygen! -->
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Virtual Memory Manager
   </div>
   <div id="projectbrief">A implementation of a multithread page fault handler</div>
  </td>
 </tr>
   <tr><td colspan="2">        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect" class="search-icon" onmouseover="return searchBox.OnSearchSelectShow()" onmouseout="return searchBox.OnSearchSelectHide()"><span class="search-icon-dropdown"></span></span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><div id="MSearchCloseImg" class="close-icon"></div></a>
          </span>
        </div>
</td></tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.14.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
</div><!-- top -->
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('writer__thread_8h.html','',''); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',false,false,'search.php','Search',true);
});
</script>
<div id="main-nav"></div>
<div id="container"><div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">writer_thread.h File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="structures_8h_source.html">../variables/structures.h</a>&quot;</code><br />
</div>
<p><a href="writer__thread_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-func-members" class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aceffc0c611417314bc308aadade3546e" id="r_aceffc0c611417314bc308aadade3546e"><td class="memItemLeft" align="right" valign="top">DWORD&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aceffc0c611417314bc308aadade3546e">diskWriter</a> (LPVOID threadContext)</td></tr>
<tr class="memdesc:aceffc0c611417314bc308aadade3546e"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function takes pages off the modified list and tries to write them to disk. It batch writes pages to disk to be more effiecient.  <br /></td></tr>
<tr class="memitem:a35e935e312d3a0dd5426a5f2c4e97f0e" id="r_a35e935e312d3a0dd5426a5f2c4e97f0e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structpfn.html">pfn</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a35e935e312d3a0dd5426a5f2c4e97f0e">getPageFromModifiedList</a> (VOID)</td></tr>
<tr class="memitem:a78be49ecefee026c3571621395261391" id="r_a78be49ecefee026c3571621395261391"><td class="memItemLeft" align="right" valign="top">VOID&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a78be49ecefee026c3571621395261391">updatePage</a> (<a class="el" href="structpfn.html">pfn</a> *page, ULONG64 index)</td></tr>
<tr class="memdesc:a78be49ecefee026c3571621395261391"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function updates the page to hold a disk index and change its status to write in progress and standby.  <br /></td></tr>
<tr class="memitem:a331448a4683f206d3cb92892b4677ad4" id="r_a331448a4683f206d3cb92892b4677ad4"><td class="memItemLeft" align="right" valign="top">VOID&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a331448a4683f206d3cb92892b4677ad4">getPagesFromModifiedList</a> (PULONG64 localBatchSizePointer, <a class="el" href="structpfn.html">pfn</a> **pfnArray, PULONG64 diskIndexArray, PULONG64 frameNumberArray, <a class="el" href="structures_8h.html#a0d2bf865b114b5aa46dd6f5558f60df4">PTHREAD_INFO</a> info)</td></tr>
<tr class="memdesc:a331448a4683f206d3cb92892b4677ad4"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function pops pages off the modified list and updates their status as standby, in progress write, and gives them a disk index.  <br /></td></tr>
<tr class="memitem:ab3e2cd6fe53fb407f9bc0de23eb41c1d" id="r_ab3e2cd6fe53fb407f9bc0de23eb41c1d"><td class="memItemLeft" align="right" valign="top">VOID&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab3e2cd6fe53fb407f9bc0de23eb41c1d">writeToDisk</a> (ULONG64 localBatchSize, PULONG64 frameNumberArray, PULONG64 diskAddressArray)</td></tr>
<tr class="memdesc:ab3e2cd6fe53fb407f9bc0de23eb41c1d"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function maps physical pages to an interim va in order to read the contents into the disk at specified indices.  <br /></td></tr>
<tr class="memitem:abc718a9fc0ca8291a2acd196af8334cb" id="r_abc718a9fc0ca8291a2acd196af8334cb"><td class="memItemLeft" align="right" valign="top">VOID&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#abc718a9fc0ca8291a2acd196af8334cb">addToStandBy</a> (ULONG64 localBatchSize, <a class="el" href="structpfn.html">pfn</a> **pfnArray, <a class="el" href="structures_8h.html#a0d2bf865b114b5aa46dd6f5558f60df4">PTHREAD_INFO</a> threadInfo)</td></tr>
<tr class="memdesc:abc718a9fc0ca8291a2acd196af8334cb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds pages from an array onto the standby list.  <br /></td></tr>
<tr class="memitem:a8af176e5e6ce9fc63b2235dacf95cdb8" id="r_a8af176e5e6ce9fc63b2235dacf95cdb8"><td class="memItemLeft" align="right" valign="top">VOID&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8af176e5e6ce9fc63b2235dacf95cdb8">freeUnusedDiskSlots</a> (PULONG64 diskIndexArray, ULONG64 start, ULONG64 end)</td></tr>
<tr class="memdesc:a8af176e5e6ce9fc63b2235dacf95cdb8"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function frees a specified range of disk indices in a given array.  <br /></td></tr>
<tr class="memitem:a2b89eecb0dc156e4930c2cac0a9ebd11" id="r_a2b89eecb0dc156e4930c2cac0a9ebd11"><td class="memItemLeft" align="right" valign="top">VOID&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2b89eecb0dc156e4930c2cac0a9ebd11">getDiskAddressesFromDiskIndices</a> (PULONG64 indices, PULONG64 addresses, ULONG64 size)</td></tr>
<tr class="memdesc:a2b89eecb0dc156e4930c2cac0a9ebd11"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function converts indices to addresses by multiplying by page size and adding the disk base.  <br /></td></tr>
</table>
<a name="doc-func-members" id="doc-func-members"></a><h2 id="header-doc-func-members" class="groupheader">Function Documentation</h2>
<a id="abc718a9fc0ca8291a2acd196af8334cb" name="abc718a9fc0ca8291a2acd196af8334cb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abc718a9fc0ca8291a2acd196af8334cb">&#9670;&#160;</a></span>addToStandBy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">VOID addToStandBy </td>
          <td>(</td>
          <td class="paramtype">ULONG64</td>          <td class="paramname"><span class="paramname"><em>localBatchSize</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structpfn.html">pfn</a> **</td>          <td class="paramname"><span class="paramname"><em>pfnArray</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structures_8h.html#a0d2bf865b114b5aa46dd6f5558f60df4">PTHREAD_INFO</a></td>          <td class="paramname"><span class="paramname"><em>info</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Adds pages from an array onto the standby list. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">localBatchSize</td><td>The number of pages to add </td></tr>
    <tr><td class="paramname">pfnArray</td><td>An array of page pointers </td></tr>
    <tr><td class="paramname">info</td><td>The info about the caller </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aceffc0c611417314bc308aadade3546e" name="aceffc0c611417314bc308aadade3546e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aceffc0c611417314bc308aadade3546e">&#9670;&#160;</a></span>diskWriter()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">DWORD diskWriter </td>
          <td>(</td>
          <td class="paramtype">LPVOID</td>          <td class="paramname"><span class="paramname"><em>info</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function takes pages off the modified list and tries to write them to disk. It batch writes pages to disk to be more effiecient. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">info</td><td>A pointer to a thread info struct. Passed in during the function CreateThread </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>If the program succeeds </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a8af176e5e6ce9fc63b2235dacf95cdb8" name="a8af176e5e6ce9fc63b2235dacf95cdb8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8af176e5e6ce9fc63b2235dacf95cdb8">&#9670;&#160;</a></span>freeUnusedDiskSlots()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">VOID freeUnusedDiskSlots </td>
          <td>(</td>
          <td class="paramtype">PULONG64</td>          <td class="paramname"><span class="paramname"><em>diskIndexArray</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ULONG64</td>          <td class="paramname"><span class="paramname"><em>start</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ULONG64</td>          <td class="paramname"><span class="paramname"><em>end</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function frees a specified range of disk indices in a given array. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">diskIndexArray</td><td>An array of disk indices </td></tr>
    <tr><td class="paramname">start</td><td>Where to start freeing in the array of disk indices. </td></tr>
    <tr><td class="paramname">end</td><td>Where to finish freeing in the array of disk indices. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a2b89eecb0dc156e4930c2cac0a9ebd11" name="a2b89eecb0dc156e4930c2cac0a9ebd11"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2b89eecb0dc156e4930c2cac0a9ebd11">&#9670;&#160;</a></span>getDiskAddressesFromDiskIndices()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">VOID getDiskAddressesFromDiskIndices </td>
          <td>(</td>
          <td class="paramtype">PULONG64</td>          <td class="paramname"><span class="paramname"><em>indices</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PULONG64</td>          <td class="paramname"><span class="paramname"><em>addresses</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ULONG64</td>          <td class="paramname"><span class="paramname"><em>size</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function converts indices to addresses by multiplying by page size and adding the disk base. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">indices</td><td>Array of disk indices that is used to get the disk addresses </td></tr>
    <tr><td class="paramname">addresses</td><td>Array of addresses that will be filled in by this function </td></tr>
    <tr><td class="paramname">size</td><td>The size of the arrays </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a35e935e312d3a0dd5426a5f2c4e97f0e" name="a35e935e312d3a0dd5426a5f2c4e97f0e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a35e935e312d3a0dd5426a5f2c4e97f0e">&#9670;&#160;</a></span>getPageFromModifiedList()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structpfn.html">pfn</a> * getPageFromModifiedList </td>
          <td>(</td>
          <td class="paramtype">VOID</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a331448a4683f206d3cb92892b4677ad4" name="a331448a4683f206d3cb92892b4677ad4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a331448a4683f206d3cb92892b4677ad4">&#9670;&#160;</a></span>getPagesFromModifiedList()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">VOID getPagesFromModifiedList </td>
          <td>(</td>
          <td class="paramtype">PULONG64</td>          <td class="paramname"><span class="paramname"><em>localBatchSizePointer</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structpfn.html">pfn</a> **</td>          <td class="paramname"><span class="paramname"><em>pfnArray</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PULONG64</td>          <td class="paramname"><span class="paramname"><em>diskIndexArray</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PULONG64</td>          <td class="paramname"><span class="paramname"><em>frameNumberArray</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structures_8h.html#a0d2bf865b114b5aa46dd6f5558f60df4">PTHREAD_INFO</a></td>          <td class="paramname"><span class="paramname"><em>threadContext</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function pops pages off the modified list and updates their status as standby, in progress write, and gives them a disk index. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">localBatchSizePointer</td><td>A pointer to our local batch size. If there are less pages on the modified list than disk indices, the function will update the contents of the pointer to reflect that change. </td></tr>
    <tr><td class="paramname">pfnArray</td><td>A location for this function to store the pages it pops of the modified list. </td></tr>
    <tr><td class="paramname">diskIndexArray</td><td>An array of disk indices to update the pfns. </td></tr>
    <tr><td class="paramname">frameNumberArray</td><td>An array of frame numbers to be filled in. </td></tr>
    <tr><td class="paramname">threadContext</td><td>The thread info of the caller. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a78be49ecefee026c3571621395261391" name="a78be49ecefee026c3571621395261391"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a78be49ecefee026c3571621395261391">&#9670;&#160;</a></span>updatePage()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">VOID updatePage </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structpfn.html">pfn</a> *</td>          <td class="paramname"><span class="paramname"><em>page</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ULONG64</td>          <td class="paramname"><span class="paramname"><em>diskIndex</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function updates the page to hold a disk index and change its status to write in progress and standby. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">page</td><td>The page to update </td></tr>
    <tr><td class="paramname">diskIndex</td><td>The disk index to store in the page </td></tr>
  </table>
  </dd>
</dl>
<dl class="section pre"><dt>Precondition</dt><dd>The page must be locked. </dd></dl>
<dl class="section post"><dt>Postcondition</dt><dd>The caller must release the page lock. </dd></dl>

</div>
</div>
<a id="ab3e2cd6fe53fb407f9bc0de23eb41c1d" name="ab3e2cd6fe53fb407f9bc0de23eb41c1d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab3e2cd6fe53fb407f9bc0de23eb41c1d">&#9670;&#160;</a></span>writeToDisk()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">VOID writeToDisk </td>
          <td>(</td>
          <td class="paramtype">ULONG64</td>          <td class="paramname"><span class="paramname"><em>localBatchSize</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PULONG64</td>          <td class="paramname"><span class="paramname"><em>frameNumberArray</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PULONG64</td>          <td class="paramname"><span class="paramname"><em>diskAddressArray</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function maps physical pages to an interim va in order to read the contents into the disk at specified indices. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">localBatchSize</td><td>The number of diskSlots and frames passed </td></tr>
    <tr><td class="paramname">frameNumberArray</td><td>An array of frame numbers </td></tr>
    <tr><td class="paramname">diskAddressArray</td><td>An array of diskAddresses </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a href="dir_8661c181a5e32e4691154f1e13423251.html">threads</a></li><li class="navelem"><a href="writer__thread_8h.html">writer_thread.h</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.14.0 </li>
  </ul>
</div>
</body>
</html>
